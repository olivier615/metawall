"use strict";(self["webpackChunkposts_wall"]=self["webpackChunkposts_wall"]||[]).push([[828],{2828:function(t,e,i){i.r(e),i.d(e,{default:function(){return I}});var s=i(6252),o=i(9963);const r={class:"col-md-7"},a=(0,s._)("div",{class:"border border-2 border-dark py-3 position-relative bg-white mb-3"},[(0,s._)("h3",{class:"text-center mb-0 fw-bold"},"張貼動態"),(0,s._)("div",{class:"position-absolute border py-3 border-dark border-2 w-100 bg-white",style:{"z-index":"-1",top:"4px",left:"-6px"}},[(0,s._)("h3",{class:"text-center mb-0 fw-bold"},"張貼動態")])],-1),n={class:"card border-2 border-dark cus-border-radio cus-shadow-bottom"},d={class:"card-body p-4"},l={class:"form-group mb-3"},p=(0,s._)("label",{for:"content"},[(0,s._)("span",{class:"fw-bolder"},"貼文內容")],-1),c={class:"input-group mb-2"},g={class:"btn btn-dark"},b=(0,s.Uk)(" 上傳圖片 "),m={key:0,class:"spinner-border spinner-border-sm",role:"status"},u=["src"],h=(0,s._)("p",{class:"text-warning text-center mt-2 mb-2 fs-7 d-none"}," 圖片檔案過大，僅限 1mb 以下檔案 ",-1),f=(0,s._)("p",{class:"text-warning text-center mt-2 mb-2 fs-7 d-none"}," 圖片格式錯誤，僅限 JPG、PNG 圖片 ",-1),w={class:"d-flex justify-content-center"},k={key:0,type:"submit",class:"btn btn-blue-dark btn-lg py-3 px-8 mt-5 text-white border-2 border-dark fw-bolder"},y=(0,s.Uk)("送出貼文 "),_={key:0,class:"spinner-border spinner-border-sm",role:"status"},v={key:1,disabled:"",type:"submit",class:"btn btn-gray-dark btn-lg py-3 px-8 mt-5 text-dark border-2 border-dark fw-bolder"};function x(t,e,i,x,L,U){return(0,s.wg)(),(0,s.iD)("div",r,[a,(0,s._)("form",{onSubmit:e[3]||(e[3]=(0,o.iM)(((...t)=>U.addNewPost&&U.addNewPost(...t)),["prevent"]))},[(0,s._)("div",n,[(0,s._)("div",d,[(0,s._)("div",l,[p,(0,s.wy)((0,s._)("textarea",{class:"form-control border-2 border-dark mt-1 py-2 px-3 no-border-radius fw-bolder",rows:"5",placeholder:"輸入您的貼文內容","onUpdate:modelValue":e[0]||(e[0]=t=>L.data.content=t)},null,512),[[o.nr,L.data.content]])]),(0,s._)("div",c,[(0,s._)("label",g,[(0,s._)("input",{ref:"upload_img",style:{display:"none"},type:"file",onChange:e[1]||(e[1]=(...t)=>U.uploadImage&&U.uploadImage(...t))},null,544),b,L.isLoading?((0,s.wg)(),(0,s.iD)("div",m)):(0,s.kq)("",!0)]),L.imgUrl?((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:e[2]||(e[2]=(0,o.iM)((t=>L.imgUrl=""),["prevent"]))}," 刪除圖片 ")):(0,s.kq)("",!0)]),this.imgUrl?((0,s.wg)(),(0,s.iD)("img",{key:0,src:this.imgUrl,class:"cus-border-radio img-fluid border border-2 border-dark",alt:"postImage",style:{width:"100%"}},null,8,u)):(0,s.kq)("",!0),h,f,(0,s._)("div",w,[L.data.content?((0,s.wg)(),(0,s.iD)("button",k,[y,L.isLoading?((0,s.wg)(),(0,s.iD)("div",_)):(0,s.kq)("",!0)])):((0,s.wg)(),(0,s.iD)("button",v,"送出貼文"))])])])],32)])}var L=i(4902),U={data(){return{isLoading:!1,fileInput:null,url:"https://fathomless-earth-71463.herokuapp.com/api",imgUrl:"",data:{content:"",type:"group",image:""}}},methods:{addNewPost(){if(this.isLoading=!0,""===this.data.content){const t={icon:"warning",title:"請輸入貼文內容"};L.Z.emit("popToast",t),this.isLoading=!1}else""!==this.imgUrl&&(this.data.image=this.imgUrl),this.$http.post(`${this.url}/posts`,this.data).then((()=>{const t={icon:"success",title:"已新增貼文"};L.Z.emit("popToast",t),this.isLoading=!1,this.$router.push("/postWall")})).catch((()=>{const t={icon:"error",title:"貼文上傳失敗"};L.Z.emit("popToast",t),this.isLoading=!1}))},uploadImage(){this.isLoading=!0;const t=this.fileInput.files[0];if(!t){const t={icon:"warning",title:"未選擇圖片檔案"};return L.Z.emit("popToast",t),void(this.isLoading=!1)}if("image/jpeg"!==t.type&&"image/png"!==t.type&&"image/jpg"!==t.type&&"image/gif"!==t.type){const t={icon:"warning",title:"檔案類別僅限 jpg, jpeg, png 或 gif"};return L.Z.emit("popToast",t),void(this.isLoading=!1)}if(t.size>2097152){const t={icon:"warning",title:"上傳檔案須小於 2 MB"};return L.Z.emit("popToast",t),void(this.isLoading=!1)}const e=new FormData;e.append("image",t),this.$http.post(`${this.url}/upload`,e).then((t=>{this.imgUrl=t.data.imgUrl,this.isLoading=!1})).catch((t=>{const e={icon:"error",title:t.response.data.message};L.Z.emit("popToast",e),this.isLoading=!1}))}},mounted(){this.fileInput=this.$refs.upload_img}},D=i(3744);const Z=(0,D.Z)(U,[["render",x]]);var I=Z}}]);
//# sourceMappingURL=828.96fea691.js.map