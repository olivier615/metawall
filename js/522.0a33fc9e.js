"use strict";(self["webpackChunkposts_wall"]=self["webpackChunkposts_wall"]||[]).push([[522],{6522:function(t,e,o){o.r(e),o.d(e,{default:function(){return $}});var s=o(6252),r=o(9963);const i={class:"col-md-7"},n=(0,s._)("div",{class:"border border-2 border-dark py-3 position-relative bg-white mb-3"},[(0,s._)("h3",{class:"text-center mb-0 fw-bold"},"編輯動態"),(0,s._)("div",{class:"position-absolute border py-3 border-dark border-2 w-100 bg-white",style:{"z-index":"-1",top:"4px",left:"-6px"}},[(0,s._)("h3",{class:"text-center mb-0 fw-bold"},"編輯動態")])],-1),a={class:"card border-2 border-dark cus-border-radio cus-shadow-bottom"},l={class:"card-body p-4"},p={class:"form-group mb-3"},d=(0,s._)("label",{for:"content"},[(0,s._)("span",{class:"fw-bolder"},"貼文內容")],-1),c={class:"input-group mb-2"},b={class:"btn btn-dark"},u=(0,s.Uk)(" 上傳圖片 "),m=["src"],g=(0,s._)("p",{class:"text-warning text-center mt-2 mb-2 fs-7 d-none"}," 圖片檔案過大，僅限 1mb 以下檔案 ",-1),h=(0,s._)("p",{class:"text-warning text-center mt-2 mb-2 fs-7 d-none"}," 圖片格式錯誤，僅限 JPG、PNG 圖片 ",-1),f={class:"d-flex justify-content-center"},w={key:0,type:"submit",class:"btn btn-blue-dark btn-lg py-3 px-8 mt-5 text-white border-2 border-dark fw-bolder"},y={key:1,disabled:"",type:"submit",class:"btn btn-gray-dark btn-lg py-3 px-8 mt-5 text-dark border-2 border-dark fw-bolder"};function k(t,e,o,k,_,v){return(0,s.wg)(),(0,s.iD)("div",i,[n,(0,s._)("form",{onSubmit:e[3]||(e[3]=(0,r.iM)(((...t)=>v.uploadEditPost&&v.uploadEditPost(...t)),["prevent"]))},[(0,s._)("div",a,[(0,s._)("div",l,[(0,s._)("div",p,[d,(0,s.wy)((0,s._)("textarea",{class:"form-control border-2 border-dark mt-1 py-2 px-3 no-border-radius fw-bolder",rows:"5",placeholder:"輸入您的貼文內容","onUpdate:modelValue":e[0]||(e[0]=t=>_.post.content=t)},null,512),[[r.nr,_.post.content]])]),(0,s._)("div",c,[(0,s._)("label",b,[(0,s._)("input",{ref:"upload_img",style:{display:"none"},type:"file",onChange:e[1]||(e[1]=(...t)=>v.uploadImage&&v.uploadImage(...t))},null,544),u]),_.imgUrl?((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:e[2]||(e[2]=(0,r.iM)((t=>_.imgUrl=""),["prevent"]))}," 刪除圖片 ")):(0,s.kq)("",!0)]),_.imgUrl?((0,s.wg)(),(0,s.iD)("img",{key:0,src:_.imgUrl,class:"cus-border-radio img-fluid border border-2 border-dark",alt:"postImage",style:{width:"100%"}},null,8,m)):(0,s.kq)("",!0),g,h,(0,s._)("div",f,[_.post.content?((0,s.wg)(),(0,s.iD)("button",w,"儲存貼文")):((0,s.wg)(),(0,s.iD)("button",y,"儲存貼文"))])])])],32)])}var _=o(4902),v={data(){return{fileInput:null,url:"https://fathomless-earth-71463.herokuapp.com/api",imgUrl:"",post:{}}},methods:{getEditPost(){const{id:t}=this.$route.params;this.$http.get(`${this.url}/posts/${t}`).then((t=>{this.post=t.data.data,this.imgUrl=this.post.image}))},uploadEditPost(){if(""===this.post.content){const t={icon:"warning",title:"請輸入貼文內容"};_.Z.emit("popToast",t)}else{const t={content:this.post.content,image:this.imgUrl};this.$http.patch(`${this.url}/posts/${this.post._id}`,t).then((()=>{const t={icon:"success",title:"已編輯貼文"};_.Z.emit("popToast",t),this.$router.push("/postWall")})).catch((()=>{const t={icon:"error",title:"貼文編輯失敗"};_.Z.emit("popToast",t)}))}},uploadImage(){const t=this.fileInput.files[0];if(!t){const t={icon:"warning",title:"未選擇圖片檔案"};return void _.Z.emit("popToast",t)}if("image/jpeg"!==t.type&&"image/png"!==t.type&&"image/jpg"!==t.type&&"image/gif"!==t.type){const t={icon:"warning",title:"檔案類別僅限 jpg, jpeg, png 或 gif"};return void _.Z.emit("popToast",t)}if(t.size>2097152){const t={icon:"warning",title:"上傳檔案須小於 2 MB"};return void _.Z.emit("popToast",t)}const e=new FormData;e.append("image",t),this.$http.post(`${this.url}/upload`,e).then((t=>{this.imgUrl=t.data.imgUrl})).catch((t=>{const e={icon:"error",title:t.response.data.message};_.Z.emit("popToast",e)}))}},mounted(){this.fileInput=this.$refs.upload_img,this.getEditPost()}},x=o(3744);const U=(0,x.Z)(v,[["render",k]]);var $=U}}]);
//# sourceMappingURL=522.0a33fc9e.js.map